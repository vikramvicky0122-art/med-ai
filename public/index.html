<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Advanced Medical AI Assistant</title>
    <link rel="stylesheet" href="style.css">
</head>

<body>
    <div class="container">
        <header>
            <h1>Medical AI Assistant</h1>
            <p>Complete patient management with AI-powered analysis and billing</p>
        </header>

        <div class="main-content">
            <!-- Patient Information Section -->
            <div class="section patient-info">
                <h2>Patient Information</h2>

                <div class="form-group">
                    <label>Patient Name:</label>
                    <input type="text" id="patientName" placeholder="Enter patient full name" required>
                </div>

                <div class="form-group">
                    <label>Gender:</label>
                    <select id="patientGender">
                        <option value="Male">Male</option>
                        <option value="Female">Female</option>
                        <option value="Other">Other</option>
                    </select>
                </div>

                <div class="form-group">
                    <label>Clinical Notes:</label>
                    <textarea id="clinicalNotes" rows="4"
                        placeholder="Enter patient symptoms, diagnosis, and clinical observations" required></textarea>
                </div>

                <div class="form-group">
                    <label>Current Medications:</label>
                    <input type="text" id="currentMeds"
                        placeholder="Enter comma-separated drug names (e.g., Metformin, Lisinopril)">
                </div>

                <button class="btn btn-primary" onclick="savePatient()">ðŸ’¾ Save Patient Information</button>

                <div id="patientStatus" class="patient-status" style="display: none;">
                    <div class="status-active">
                        âœ… Patient: <span id="currentPatientName">Not Set</span> |
                        Gender: <span id="currentPatientGender">Not Set</span> |
                        Saved: <span id="patientSaveTime">Not Set</span>
                    </div>
                </div>
            </div>
            <!-- Medical Coding Section -->
            <div class="section coding-section">
                <h2>Medical Coding & AI Automation</h2>

                <div class="ai-automation-buttons">
                    <button class="btn btn-ai" onclick="autoSuggestCodes()" id="aiCodesBtn">
                        ðŸ§  AI Suggest ICD-10 Codes
                    </button>
                    <button class="btn btn-ai" onclick="autoSuggestMedications()">
                        ðŸ’Š AI Suggest Medications
                    </button>
                    <button class="btn btn-ai-primary" onclick="autoCompleteAllBilling()">
                        ðŸš€ AI Complete All Billing
                    </button>
                    <button class="btn btn-test" onclick="testAIConnection()"
                        style="background: #ffc107; color: black;">
                        ðŸ”§ Test AI Connection
                    </button>
                </div>

                <div class="form-group">
                    <label>ICD-10 Code (Manual Entry):</label>
                    <div class="input-with-button">
                        <input type="text" id="icd10Code" placeholder="e.g., J06.9, I10, E11.9"
                            pattern="[A-Z][0-9]{2}(\.[0-9]{1,2})?">
                        <button class="btn btn-secondary" onclick="addIcd10Code()">+ Add Code</button>
                    </div>
                    <small class="input-hint">Format: Letter + Numbers + optional decimal (e.g., J06.9)</small>
                </div>

                <div id="codeList" class="code-list">
                    <div class="no-codes">No ICD-10 codes added yet. Use AI suggestion or add manually.</div>
                </div>

                <div class="form-group">
                    <label>Medications for Billing:</label>
                    <div id="medicationList">
                        <div class="medication-item">
                            <input type="text" placeholder="Medication name" class="med-name">
                            <input type="number" placeholder="Cost" class="med-cost" step="0.01" min="0">
                            <button class="btn btn-small btn-danger" onclick="removeMedication(this)">Ã—</button>
                        </div>
                    </div>
                    <button class="btn btn-secondary" onclick="addMedication()">+ Add Medication</button>
                </div>
            </div>
            <!-- Upload Medical Documents Section -->
            <div class="section upload-section">
                <h2>Upload Medical Documents</h2>

                <div class="upload-area" id="uploadArea">
                    <!-- Content will be updated by JavaScript -->
                </div>

                <input type="file" id="fileInput" accept=".pdf,.jpg,.jpeg,.png,.txt,.gif" style="display: none;">

                <div id="uploadProgress" class="progress-container" style="display: none;">
                    <div class="progress-bar">
                        <div class="progress-fill" id="progressFill"></div>
                    </div>
                    <span id="progressText">Uploading...</span>
                </div>

                <div class="upload-help">
                    <small>
                        <strong>Supported files:</strong> PDF, JPG, PNG, TXT (max 10MB)<br>
                        <strong>Tip:</strong> Save patient information first for better AI analysis
                    </small>
                </div>

                <div style="margin-top: 15px;">
                    <button class="btn btn-test" onclick="testUpload()" style="background: #ffc107; color: black;">
                        ðŸ§ª Test Upload
                    </button>
                </div>
            </div>
            <!-- AI Assistant Section -->
            <div class="section ai-section">
                <h2>AI Prescription Assistant</h2>

                <div id="chatBox" class="chat-box">
                    <div class="ai-message">
                        <strong>AI Assistant:</strong> Hello! I'm your AI prescription assistant. I can analyze uploaded
                        prescriptions, suggest medications, and help with treatment planning.
                    </div>
                </div>

                <div class="chat-input">
                    <input type="text" id="userInput"
                        placeholder="Ask about medications, treatment options, or analysis...">
                    <button class="btn btn-primary" onclick="sendMessage()">Send</button>
                </div>
            </div>
            <!-- Billing Section -->
            <div class="section billing-section">
                <h2>Billing & Export</h2>

                <div class="form-group">
                    <label>Additional AI Suggestions:</label>
                    <textarea id="aiSuggestions" rows="3"
                        placeholder="AI will provide additional medication suggestions here..."></textarea>
                </div>

                <div class="billing-actions">
                    <button class="btn btn-success" onclick="generateBill()">
                        ðŸ§¾ Generate Complete Bill
                    </button>
                    <button class="btn btn-success" onclick="quickDownload()">
                        âš¡ Quick Download
                    </button>
                    <button class="btn btn-secondary" onclick="exportIcd10Codes()">
                        ðŸ“‹ Export ICD-10 Codes
                    </button>
                </div>

                <div class="billing-summary">
                    <h4>Billing Summary</h4>
                    <div id="billingDetails"></div>
                    <div class="total-amount" id="totalAmount">Total: $0.00</div>
                </div>

                <div id="downloadSection"
                    style="display: none; margin-top: 20px; padding: 15px; background: #e8f5e8; border-radius: 8px; border: 2px solid #28a745;">
                    <h4>âœ… Bill Ready for Download</h4>
                    <p>Your bill has been generated successfully!</p>
                    <a id="downloadLink" class="btn btn-download" style="display: inline-block; margin-top: 10px;">
                        ðŸ“„ Download Bill PDF
                    </a>
                </div>
            </div>
        </div>
    </div>

    <script src="script.js"></script>
</body>

</html>